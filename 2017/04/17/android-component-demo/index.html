<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="android,node.js,react native,ios,mongodb,weex,java"><title>Android项目组件化实战 | 哒哒</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Android项目组件化实战</h1><a id="logo" href="/.">哒哒</a><p class="description">Keep engineers playfully</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/flowchart/"><i class="fa fa-github"> 流图</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Android项目组件化实战</h1><div class="post-meta"><a href="/2017/04/17/android-component-demo/#comments" class="comment-count"></a><p><span class="date">Apr 17, 2017</span><span><a href="/categories/Android/" class="category">Android</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>随着业务的叠加、版本的迭代，我们的App变得越来越臃肿，分离关注点、项目解耦势在必行，本博客将讲解Android项目组件化过程中的实践。</p>
<a id="more"></a>
<h2 id="组件化介绍"><a href="#组件化介绍" class="headerlink" title="组件化介绍"></a>组件化介绍</h2><p>随着项目版本的迭代，业务需求叠加和复杂度提升，代码量越来越多，甚至有多个团队重复开发某一类似模块功能，这个时候再继续开发迭代将会存在以下问题。</p>
<ul>
<li>一个小小的功能改动，就要全局编译，编译等待时长过多</li>
<li>各种业务模块耦合在一起，不利于维护和架构升级</li>
<li>代码量越来越庞大，需要进行合理拆分</li>
<li>对于测试团队来说，新功能无法单独调试</li>
<li>某个功能的改动，有可能需要进行全局测试</li>
</ul>
<h3 id="组件化与插件化"><a href="#组件化与插件化" class="headerlink" title="组件化与插件化"></a>组件化与插件化</h3><ul>
<li>组件化</li>
</ul>
<p>根据业务、功能和模块细粒度将其合理的分为<code>模块组件</code>和<code>通用组件</code>，比如：业务组件、UI组件、依赖组件、基类组件等。在实际开发中可以分为：分享组件、注册登录组件、商品分类组件、地址选择组件、商品详情组件；商品列表下拉刷新上啦加载更多UI组件，轮播图组件等。将这些不同团队可通用的功能模块封装为组件存在，供不同APP开发团队使用。</p>
<p><img src="http://oqle0m5m6.bkt.clouddn.com/%E7%BB%84%E4%BB%B6%E5%8C%96%E6%9E%B6%E6%9E%84.png" alt=""></p>
<p>如上图所示，在开发阶段将整个App分割为不同的组件，各个组件可以并行开发而且还可以单独测试；各个组件开发完备之后将各个组件组合成真正需要的Apk。</p>
<ul>
<li>插件化</li>
</ul>
<p>将一个APK划分为不同的“小apk”，在需要使用的时候将其“插”到宿主APK进行工作。</p>
<p><img src="http://oqle0m5m6.bkt.clouddn.com/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%9E%B6%E6%9E%84%20%281%29.png" alt=""></p>
<p>如上图所示，Apk包含有多个模块，宿主模块和插件模块，每一个模块都是一个Apk，将每一个插件Apk开发完成之后与宿主Apk进行打包。</p>
<h3 id="组件化特点"><a href="#组件化特点" class="headerlink" title="组件化特点"></a>组件化特点</h3><p>组件化优点：</p>
<ul>
<li>业务组件可以单独开发，整个App可并行开发</li>
<li>单个业务组件开发的技术选型和架构选择并不会影响整个App</li>
<li>普通开发人员的开发任务聚焦到单个组件，了解整个App的模块、架构迫切性降低</li>
<li>开发效率提高，开发中只需维护自己开发的组件</li>
<li>优秀通用代码集可封装为组件(库)，方便不同业务线App复用</li>
<li>不涉及特有业务能够加速App开发的组件(库)，可以在Github开源</li>
<li>组件可单独测试，无需整个App功能开发完成才进行测试，缩短发布周期</li>
</ul>
<p>组件化的缺点：</p>
<ul>
<li>组件划分的界限及细粒度不好把握</li>
</ul>
<h3 id="插件化特点"><a href="#插件化特点" class="headerlink" title="插件化特点"></a>插件化特点</h3><p>插件化优点：</p>
<ul>
<li>对Apk进行模块之间的解耦</li>
<li>开发效率提高，团队可进行并行开发</li>
<li>实现插件的动态升级</li>
<li>按是否需要插件功能加载Apk节省内存</li>
</ul>
<p>插件化缺点：</p>
<ul>
<li>技术要求比较高</li>
<li>插件化框架对某些功能的支持并不好</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>组件化和插件化都是为了模块解耦，避免不同模块之间的依赖耦合，提升整个团队的开发效率。组件化和插件化都可以单独测试组件和Apk，各个模块高度解耦，每个模块都是单独的存在并不依赖于其他模块。</p>
<p>相比而言，组件化开发的技术要求较低，并不需要关注插件化开发需要关注的hook技术、类加载、资源加载以及不同组件的支持程度等问题。大型App的项目协作开发中，比较倾向应用组件化；假如技术团队特牛，有比较成熟的插件加载框架，还是可以试试插件化开发，比较插件化可以实现插件动态升级，免去因为模块功能升级导致整个App升级，还有就是插件化可实现按需加载节省内存。</p>
<h2 id="搭建组件化基础架构"><a href="#搭建组件化基础架构" class="headerlink" title="搭建组件化基础架构"></a>搭建组件化基础架构</h2><h3 id="组件以及第三方SDK的版本控制"><a href="#组件以及第三方SDK的版本控制" class="headerlink" title="组件以及第三方SDK的版本控制"></a>组件以及第三方SDK的版本控制</h3><p>为了实现统一管理各个Module<code>build.gradle</code>属性的设置，首先，在项目根目录下新建一个<code>config.gradle</code>文件用于统一管理版本信息。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">ext &#123;</div><div class="line">    isApp = <span class="keyword">false</span></div><div class="line">    android = [</div><div class="line">            compileSdkVersion: <span class="number">26</span>,</div><div class="line">            buildToolsVersion: <span class="string">"26.0.0"</span>,</div><div class="line">            minSdkVersion    : <span class="number">22</span>,</div><div class="line">            ...</div><div class="line">    ]</div><div class="line">    dependencies = [</div><div class="line">            recyclerviewV7        : <span class="string">'com.android.support:recyclerview-v7:26.0.0-alpha1'</span>,</div><div class="line">            butterknife           : <span class="string">'com.jakewharton:butterknife:8.8.1'</span>,</div><div class="line">            butterknifeCompiler   : <span class="string">'com.jakewharton:butterknife-compiler:8.8.1'</span>,</div><div class="line">            ...</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>接着，需要在<code>Project</code>级别的<code>build.gradle</code>文件中引入<code>config.gradle</code>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply from: <span class="string">"config.gradle"</span></div></pre></td></tr></table></figure></p>
<p>最后，需要在各个Module进行相应的配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    compileSdkVersion rootProject.ext.android.compileSdkVersion</div><div class="line">    buildToolsVersion rootProject.ext.android.buildToolsVersion</div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId <span class="string">"com.dyx.aca"</span></div><div class="line">        minSdkVersion rootProject.ext.android.minSdkVersion</div><div class="line">        targetSdkVersion rootProject.ext.android.targetSdkVersion</div><div class="line">        versionCode rootProject.ext.android.versionCode</div><div class="line">        versionName rootProject.ext.android.versionName</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">	<span class="comment">//RxXxx</span></div><div class="line">	compile rootProject.ext.dependencies.rxjava</div><div class="line">	compile rootProject.ext.dependencies.rxandroid</div><div class="line">    ...</div><div class="line">	<span class="comment">//retrofit</span></div><div class="line">	compile rootProject.ext.dependencies.retrofit</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="动态切换Module的Application与Library模式"><a href="#动态切换Module的Application与Library模式" class="headerlink" title="动态切换Module的Application与Library模式"></a>动态切换Module的Application与Library模式</h3><p>动态的切换Module的Application和Library模式有助于单独测试组件和对整个App进行测试。动态切换是通过上文在<code>config.gradle</code>中定义的<code>isApp</code>来设置，需要设置的地方有两处：其一，除主Module app之外的其他业务组件或UI组件：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (rootProject.ext.isApp) &#123;</div><div class="line">    apply plugin: <span class="string">'com.android.application'</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    apply plugin: <span class="string">'com.android.library'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其二，主Module app的<code>build.gradle</code>中需要设置，只有上文的<code>isApp</code>为<code>false</code>时才可进行组件引入：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (!rootProject.ext.isApp) &#123;</div><div class="line">    <span class="function">compile <span class="title">project</span><span class="params">(<span class="string">':co_discover'</span>)</span></span></div><div class="line"><span class="function">    compile <span class="title">project</span><span class="params">(<span class="string">':co_index'</span>)</span></span></div><div class="line"><span class="function">    compile <span class="title">project</span><span class="params">(<span class="string">':co_my'</span>)</span></span></div><div class="line"><span class="function">    compile <span class="title">project</span><span class="params">(<span class="string">':co_newsdetail'</span>)</span></span></div><div class="line"><span class="function">    compile <span class="title">project</span><span class="params">(<span class="string">':co_order'</span>)</span></span></div><div class="line"><span class="function">&#125;</span></div></pre></td></tr></table></figure></p>
<h3 id="Library组件与主app的AndroidManifest-xml合并"><a href="#Library组件与主app的AndroidManifest-xml合并" class="headerlink" title="Library组件与主app的AndroidManifest.xml合并"></a>Library组件与主app的AndroidManifest.xml合并</h3><p>我们需要在组件Module下的<code>src/main</code>中新建两个目录，分别为：<code>debug</code>和<code>release</code>，debug模式用于单独测试组件时使用，此目录的<code>AndroidManifest.xml</code>如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;manifest xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">    <span class="keyword">package</span>=<span class="string">"com.dyx.aca.co.order"</span>&gt;</div><div class="line">    &lt;application</div><div class="line">    	<span class="comment">//1、配置Application</span></div><div class="line">        android:name=<span class="string">"debug.OrderApplication"</span></div><div class="line">        android:allowBackup=<span class="string">"true"</span></div><div class="line">        android:label=<span class="string">"@string/app_name"</span></div><div class="line">        android:supportsRtl=<span class="string">"true"</span></div><div class="line">        <span class="comment">//2、设置theme</span></div><div class="line">        android:theme=<span class="string">"@style/co_order_AppTheme"</span>&gt;</div><div class="line">        <span class="comment">//3、添加Activity</span></div><div class="line">        &lt;activity android:name=<span class="string">".OrderActivity"</span>&gt;</div><div class="line">            &lt;intent-filter&gt;</div><div class="line">                &lt;action android:name=<span class="string">"android.intent.action.MAIN"</span> /&gt;</div><div class="line">                &lt;category android:name=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</div><div class="line">            &lt;/intent-filter&gt;</div><div class="line">        &lt;/activity&gt;</div><div class="line">    &lt;/application&gt;</div><div class="line">    &lt;uses-permission android:name=<span class="string">"android.permission.INTERNET"</span> /&gt;</div><div class="line">&lt;/manifest&gt;</div></pre></td></tr></table></figure></p>
<p>而在release模式下，也就是组件是以Library的形态存在时，需要做以下配置：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;manifest xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">    xmlns:tools=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line">    <span class="keyword">package</span>=<span class="string">"com.dyx.aca.co.order"</span>&gt;</div><div class="line">    &lt;application</div><div class="line">        android:allowBackup=<span class="string">"true"</span></div><div class="line">        android:label=<span class="string">"@string/co_order_app_name"</span></div><div class="line">        android:supportsRtl=<span class="string">"true"</span></div><div class="line">        tools:replace=<span class="string">"android:label"</span>&gt;</div><div class="line">        &lt;activity android:name=<span class="string">".OrderActivity"</span> /&gt;</div><div class="line">    &lt;/application&gt;</div><div class="line">&lt;/manifest&gt;</div></pre></td></tr></table></figure></p>
<p><img src="http://oqle0m5m6.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-11-01%20%E4%B8%8B%E5%8D%888.46.16.png" alt=""></p>
<p>在不同模式的切换需要添加以下代码，清理之前生成的无用资源：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ...</div><div class="line">    sourceSets &#123;</div><div class="line">        main &#123;</div><div class="line">            <span class="keyword">if</span> (rootProject.ext.isApp) &#123;</div><div class="line">                <span class="comment">//Application</span></div><div class="line">                manifest.srcFile <span class="string">'src/main/debug/AndroidManifest.xml'</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//Library</span></div><div class="line">                manifest.srcFile <span class="string">'src/main/release/AndroidManifest.xml'</span></div><div class="line">                <span class="comment">//移除debug无用资源</span></div><div class="line">                java &#123;</div><div class="line">                    exclude <span class="string">'debug/**'</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="组件Application与主app之间冲突与初始化"><a href="#组件Application与主app之间冲突与初始化" class="headerlink" title="组件Application与主app之间冲突与初始化"></a>组件Application与主app之间冲突与初始化</h3><p>为了解决组件Application与主app之间冲突与初始化的问题，我们需要在<code>java</code>目录下新建一个<code>debug</code>目录专门用于放置<code>OrderApplication.java</code>，实现只在debug模式下访问此Application。在单独测试某个组件的时候，比如引入了<a href="https://github.com/orhanobut/logger" target="_blank" rel="external">logger</a>框架，需要在Module的Application做以下配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderApplication</span> <span class="keyword">extends</span> <span class="title">Application</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate();</div><div class="line">        Logger.addLogAdapter(<span class="keyword">new</span> AndroidLogAdapter());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当需要集成测试的时候，也就是把此Module当作Library对待时，需要将<code>OrderApplication.java</code>中的内容移步到主app的<code>Application.java</code>中，如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XApplication</span> <span class="keyword">extends</span> <span class="title">Application</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate();</div><div class="line">        Logger.addLogAdapter(<span class="keyword">new</span> AndroidLogAdapter());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="组件与组件之间命名冲突"><a href="#组件与组件之间命名冲突" class="headerlink" title="组件与组件之间命名冲突"></a>组件与组件之间命名冲突</h3><p>在实际使用组件化架构团队协作开发时，无法确保两个甚至多个组件之间资源命名不相同。试想，如果能够为每个组件的资源文件盖上自己独有的戳，就能避免组件与组件之间命名冲突的问题。恰巧在gradle中有相关的语法属性支持约束资源的前缀命名：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    compileSdkVersion rootProject.ext.andro</div><div class="line">    buildToolsVersion rootProject.ext.andro</div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion rootProject.ext.andro</div><div class="line">        targetSdkVersion rootProject.ext.an</div><div class="line">        versionCode rootProject.ext.android</div><div class="line">        versionName rootProject.ext.android</div><div class="line">        <span class="keyword">if</span> (rootProject.ext.isApp) &#123;</div><div class="line">            applicationId <span class="string">"com.dyx.aca.co.s</span></div><div class="line"><span class="string">        &#125; else &#123;</span></div><div class="line"><span class="string">        &#125;</span></div><div class="line"><span class="string">        testInstrumentationRunner "</span>android.</div><div class="line">        <span class="comment">//1、添加资源文件前缀</span></div><div class="line">        resourcePrefix <span class="string">"co_settings_"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>自此在需要重建资源文件的时候，需要在<code>res</code>目录的文件添加此前缀。</p>
<h3 id="组件与组件之间跳转通信"><a href="#组件与组件之间跳转通信" class="headerlink" title="组件与组件之间跳转通信"></a>组件与组件之间跳转通信</h3><ul>
<li>通过Intent和Bundle</li>
</ul>
<p>在Android中同一个进程，可以通过Intent和Bundle进行Activity之间的跳转和简单数据传输，包括简单数据类型和可被序列化的对象：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">intentToForName</span><span class="params">(Context context, String name, String key, String value)</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Class cla = Class.forName(name);</div><div class="line">        Intent intent = <span class="keyword">new</span> Intent(context, cla);</div><div class="line">        Bundle bundle = <span class="keyword">new</span> Bundle();</div><div class="line">        bundle.putString(key, value);</div><div class="line">        intent.putExtras(bundle);</div><div class="line">        startActivity(intent);</div><div class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>使用Schema属性进行跳转</li>
</ul>
<p>在此使用开源路由框架<a href="https://github.com/mzule/ActivityRouter" target="_blank" rel="external">ActivityRouter</a>实现组件之间的跳转和数据通信，在跳转发起页面添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Routers.open(getActivity(), &quot;dayongxin://settings?name=dayongxin&quot;);</div></pre></td></tr></table></figure></p>
<p>在跳转目标页面添加以下代码获取内容，更多用法自行阅读<code>ActivityRouter</code>功能介绍：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getIntent().getStringExtra(<span class="string">"name"</span>)</div></pre></td></tr></table></figure></p>
<p>除此之外，当然也可以使用<a href="https://github.com/alibaba/ARouter" target="_blank" rel="external">ARouter</a>框架。</p>
<h2 id="组件化实战项目实现"><a href="#组件化实战项目实现" class="headerlink" title="组件化实战项目实现"></a>组件化实战项目实现</h2><p>项目整体架构如下所示，具体实现代码详见<a href="https://github.com/DoubleDa/AndroidComponentizate" target="_blank" rel="external">AndroidComponentizate</a><br><img src="http://oqle0m5m6.bkt.clouddn.com/%E7%BB%84%E4%BB%B6%E5%8C%96App%E6%9E%B6%E6%9E%84%E5%9B%BE%20%281%29.png" alt=""></p>
</div><div class="tags"><a href="/tags/组件化/">组件化</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2017/05/09/android-tinker/" class="pre">Android热修复框架Tinker应用</a><a href="/2017/03/20/android-custom-view/" class="next">Android自定义View实战</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#组件化介绍"><span class="toc-text">组件化介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#组件化与插件化"><span class="toc-text">组件化与插件化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件化特点"><span class="toc-text">组件化特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插件化特点"><span class="toc-text">插件化特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#搭建组件化基础架构"><span class="toc-text">搭建组件化基础架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#组件以及第三方SDK的版本控制"><span class="toc-text">组件以及第三方SDK的版本控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态切换Module的Application与Library模式"><span class="toc-text">动态切换Module的Application与Library模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Library组件与主app的AndroidManifest-xml合并"><span class="toc-text">Library组件与主app的AndroidManifest.xml合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件Application与主app之间冲突与初始化"><span class="toc-text">组件Application与主app之间冲突与初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件与组件之间命名冲突"><span class="toc-text">组件与组件之间命名冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件与组件之间跳转通信"><span class="toc-text">组件与组件之间跳转通信</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件化实战项目实现"><span class="toc-text">组件化实战项目实现</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/12/14/kotlin-coroutine-2/">Kotlin教程-协程(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/02/kotlin-coroutine/">Kotlin教程-协程(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/20/kotlin-class-object-2/">Kotlin教程-类和对象(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/12/kotlin-class-object-1/">Kotlin教程-类和对象(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/03/kotlin-getting-started/">Kotlin教程-基础语法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/20/springboot-mybatis/">使用Springboot+Mybatis搭建JavaEE项目</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/12/flutter-first-experience/">Flutter初体验</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/28/abstract-factory-design/">设计模式之抽象工厂模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/21/netty-websocket/">Android实现与Netty搭建Websocket服务器通信</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/14/silent-install/">Android实现静默安装自启动</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-pattern/">Design pattern</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Flutter/">Flutter</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaEE/">JavaEE</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RxJava/">RxJava</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/Glide用法/" style="font-size: 15px;">Glide用法</a> <a href="/tags/抽象工厂模式/" style="font-size: 15px;">抽象工厂模式</a> <a href="/tags/加固渠道/" style="font-size: 15px;">加固渠道</a> <a href="/tags/Android架构/" style="font-size: 15px;">Android架构</a> <a href="/tags/组件化/" style="font-size: 15px;">组件化</a> <a href="/tags/自定义View/" style="font-size: 15px;">自定义View</a> <a href="/tags/Jni和Ndk/" style="font-size: 15px;">Jni和Ndk</a> <a href="/tags/OkHttp源码解析/" style="font-size: 15px;">OkHttp源码解析</a> <a href="/tags/OkHttp用法/" style="font-size: 15px;">OkHttp用法</a> <a href="/tags/建造者模式/" style="font-size: 15px;">建造者模式</a> <a href="/tags/Tinker/" style="font-size: 15px;">Tinker</a> <a href="/tags/Realm/" style="font-size: 15px;">Realm</a> <a href="/tags/ButterKnife解析/" style="font-size: 15px;">ButterKnife解析</a> <a href="/tags/Flutter初体验/" style="font-size: 15px;">Flutter初体验</a> <a href="/tags/适配器模式/" style="font-size: 15px;">适配器模式</a> <a href="/tags/Kotlin入门/" style="font-size: 15px;">Kotlin入门</a> <a href="/tags/Glide源码解析/" style="font-size: 15px;">Glide源码解析</a> <a href="/tags/Https接口/" style="font-size: 15px;">Https接口</a> <a href="/tags/Websocket/" style="font-size: 15px;">Websocket</a> <a href="/tags/Kotlin教程/" style="font-size: 15px;">Kotlin教程</a> <a href="/tags/观察者模式/" style="font-size: 15px;">观察者模式</a> <a href="/tags/RecyclerView/" style="font-size: 15px;">RecyclerView</a> <a href="/tags/Retrofit解析/" style="font-size: 15px;">Retrofit解析</a> <a href="/tags/Retrofit/" style="font-size: 15px;">Retrofit</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a> <a href="/tags/RxJava-MVP-Retrofit/" style="font-size: 15px;">RxJava MVP Retrofit</a> <a href="/tags/静默安装/" style="font-size: 15px;">静默安装</a> <a href="/tags/单例模式/" style="font-size: 15px;">单例模式</a> <a href="/tags/Springboot-Mybatis/" style="font-size: 15px;">Springboot+Mybatis</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://guides.codepath.com/android" title="CodePath" target="_blank">CodePath</a><ul></ul><a href="https://realm.io/" title="Realm" target="_blank">Realm</a><ul></ul><a href="https://developer.android.google.cn/index.html" title="Google Android" target="_blank">Google Android</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">dayongxin.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>